<h1 class="ui header" id="session-heading">{{t 'Sessions'}}</h1>

<div class="d-flex wrap">
  <LinkTo @route="public.sessions" @models={{array this.model.event.id}} @query={{hash date=null}} class="ui button mb-2">{{t 'All'}}</LinkTo>
  {{#each this.allDates as |date|}}
    <LinkTo @route="public.sessions" @models={{array this.model.event.id}} @query={{hash date=(moment-format date "YYYY-MM-DD")}} class="ui button mb-2">{{general-date date 'D MMM, YYYY'}}</LinkTo>
  {{/each}}

  <Widgets::TimeZonePicker
    class="mb-2 ml-auto mr-2"
    @defaultLocal={{this.model.event.online}}
    @eventTimezone={{this.model.event.timezone}}
    @timezone={{this.timezone}} />

  <div class="item">
    <div class="ui icon input">
      <Input
        @name="search"
        @value={{this.search}}
        @type="text"
        @placeholder={{t "Search..."}} />
      <i class="search icon"></i>
    </div>
  </div>

  <UiDropdown class="labeled icon button mb-2">
    <i class="sort amount down icon"></i>
    <span class="default text">{{if (eq this.sort 'title') (t 'By Title') (t 'By Time')}}</span>
    <div class="menu">
      <LinkTo @route="public.sessions" @models={{array this.model.event.id}} @query={{hash sort='title'}} class="item">{{t 'By Title'}}</LinkTo>
      <LinkTo @route="public.sessions" @models={{array this.model.event.id}} @query={{hash sort='starts-at'}} class="item">{{t 'By Time'}}</LinkTo>
    </div>
  </UiDropdown>
</div>

{{!-- To be enabled and developed on later --}}
{{#if this.isTrackVisible}} 
  {{#each this.model.session as |session|}}
    <div class="ui grid">
      <div class="three wide column">
        {{general-date session.startsAt 'hh:mm a' tz=session.event.timezone}} - 
        {{general-date session.endsAt 'hh:mm a' tz=session.event.timezone}}
      </div>
      <div class="thirteen wide column">
        <Public::TrackItem @session={{session}} />
      </div>
    </div>
  {{else}}
    <div class="ui disabled header">{{t 'No Sessions exist for this time period'}}</div>
  {{/each}}
  <InfinityLoader @infinityModel={{this.model.session}} @triggerOffset={{300}} @eventDebounce={{50}}>
    <div class="center aligned five wide column">
      <div class="ui loading very padded basic segment">
      </div>
    </div>
  </InfinityLoader>
{{/if}}

<div class="mt-8">
  {{#if this.model.session}}
    <table class="ui very basic table">
      <thead class="full-width">
        <tr>
          <th class="two wide" style="border: none;"></th>
          <th style="border: none;"></th>
        </tr>
      </thead>
      <tbody>
        {{#each this.model.session as |session|}}
          <tr>
            <td class="top aligned {{unless this.device.isMobile 'centered text'}}" style="border-top: none;">
              <h4 class="ui header {{unless this.device.isMobile 'pt-4'}}" style="color: rgba(0, 0, 0, 0.7);">
                {{general-date session.startsAt 'h:mm A (z)' tz=this.timezone}}
              </h4>
            </td>
            <td style="border-top: none; border-left: 1px solid lightgrey">
              <Public::SessionItem @session={{session}} @event={{this.model.event}} @timezone={{this.timezone}} />
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  {{else}}
    <div class="ui disabled header">{{t 'No Sessions exist for this time period'}}</div>
  {{/if}}    
  <InfinityLoader @infinityModel={{this.model.session}} @triggerOffset={{300}} @eventDebounce={{50}}>
    <div class="center aligned five wide column">
      <div class="ui loading very padded basic segment">
      </div>
    </div>
  </InfinityLoader>
</div>
